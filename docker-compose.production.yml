version: "3.1"

services:
  lti:
    build:
      context: .
      args:
        - "REQUIREMENTS=${REQUIREMENTS}"
    volumes:
      - .:/app
      - $PWD/devops/nginx.conf:/app/nginx.conf
      - $PWD/devops/uwsgi.ini:/app/uwsgi.ini
    ports:
      - "80:80"
    env_file:
      - .env
    environment:
      - MODULE_NAME=app

  worker:
    build:
      context: .
      args:
        - "REQUIREMENTS=${REQUIREMENTS}"
    volumes:
      - .:/app
    command: rq worker -c config quizext
    env_file:
      - .env
# There is an expectation that on production you will have your own
# remote database and redis server setup, rather than using local
# Docker containers for that functionality.
